<script>
    // Create confetti effect on page load
    window.addEventListener('load', function () {
        createConfetti();
        setupBackButton();

        // We don't want to redirect immediately from the success page
        // All users should see the success page after form submission
        // The redirection will happen only when they click the "Back" button
    });

    function createConfetti() {
        const colors = ['#ff69b4', '#ff85c1', '#ffb6c1', '#ffc0cb', '#ffe0f0'];
        for (let i = 0; i < 100; i++) {
            setTimeout(() => {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                // Random properties
                const size = Math.random() * 10 + 5;
                const color = colors[Math.floor(Math.random() * colors.length)];
                const left = Math.random() * 100;
                const animationDuration = Math.random() * 3 + 2;
                const opacity = Math.random() * 0.5 + 0.5;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                confetti.style.backgroundColor = color;
                confetti.style.left = `${left}%`;
                confetti.style.top = `-20px`;
                confetti.style.opacity = opacity;
                confetti.style.animationDuration = `${animationDuration}s`;
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(confetti);
                // Remove confetti after animation completes
                setTimeout(() => {
                    confetti.remove();
                }, animationDuration * 1000);
            }, i * 30);
        }
    }

    function setupBackButton() {
        const backButton = document.getElementById('back-button');
        backButton.addEventListener('click', function (e) {
            e.preventDefault();
            console.log('Back button clicked');
            console.log('isOwner:', localStorage.getItem('isOwner'));
            console.log('hasAccessed:', localStorage.getItem('hasAccessed'));

            // Check if the user is the owner
            if (localStorage.getItem('isOwner') === 'true') {
                console.log('Owner access granted - redirecting to main site');
                // Owner can go back to the main site
                window.location.href = 'index.html';
            }
            // For all other users (including first-time visitors), redirect to expired page
            else {
                console.log('Redirecting to expired page');
                // Set access flag if not already set
                if (localStorage.getItem('hasAccessed') !== 'true') {
                    localStorage.setItem('hasAccessed', 'true');
                }
                // Redirect to expired page
                window.location.href = 'expired.html';
            }
        });
    }
</script>